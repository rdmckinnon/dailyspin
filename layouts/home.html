{{ define "main" }}
  {{/* Fetch latest song */}}
  {{ $songs := where site.RegularPages "Section" "songs" }}
  {{ $sorted := sort $songs "Date" "desc" }}
  {{ $latest := index $sorted 0 }}

  <section class="ds-hero-bold container">
    <div class="vinyl-decoration vinyl-1"></div>
    <div class="vinyl-decoration vinyl-2"></div>
    <div class="vinyl-decoration vinyl-3"></div>

    <div class="ds-hero-bold-inner">
      <div class="ds-hero-eyebrow">
        <span class="eyebrow-text">ONE SONG • ONE DAY</span>
      </div>
      <h1 class="ds-hero-mega">
        <span class="hero-line-1">DAILY</span>
        <span class="hero-line-2">SPIN</span>
      </h1>
      <p class="ds-hero-tagline">Your daily dose of<br><span class="tagline-accent">musical genius</span></p>
      <div class="ds-hero-ctas-bold">
        <a class="btn-bold btn-bold-primary" href="/songs/">
          <span>EXPLORE</span>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
        </a>
        {{ if $latest }}
        <a class="btn-bold btn-bold-secondary" href="{{ $latest.RelPermalink }}">
          <span>TODAY'S PICK</span>
        </a>
        {{ end }}
      </div>
      <div class="hero-stats">
        <div class="stat-item">
          <div class="stat-number">{{ len $songs }}</div>
          <div class="stat-label">TRACKS</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">365</div>
          <div class="stat-label">DAYS/YR</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">100%</div>
          <div class="stat-label">CURATED</div>
        </div>
      </div>
    </div>
  </section>

  <section class="ds-features container">
    <div class="row g-4 g-md-5">
      <div class="col-12 col-md-4">
        <div class="ds-feature">
          <!-- Tabler icon: sparkles -->
          <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3l2 4 4 2-4 2-2 4-2-4-4-2 4-2 2-4z"/><path d="M5 3l1 2 2 1-2 1-1 2-1-2-2-1 2-1 1-2z"/><path d="M19 14l1 2 2 1-2 1-1 2-1-2-2-1 2-1 1-2z"/></svg>
          <h3>Curated, not crowded</h3>
          <p>Singular focus every day. No noise, no filler—just one track that matters.</p>
        </div>
      </div>
      <div class="col-12 col-md-4">
        <div class="ds-feature">
          <!-- Tabler icon: lifebuoy (deep dive) -->
          <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="8"/><circle cx="12" cy="12" r="4"/><path d="M4.93 4.93l3.54 3.54"/><path d="M14.53 5.47l3.54-3.54"/><path d="M14.53 18.53l3.54 3.54"/><path d="M4.93 19.07l3.54-3.54"/></svg>
          <h3>Deep, elegant notes</h3>
          <p>Context, history, and the “why” behind the music—written with restraint.</p>
        </div>
      </div>
      <div class="col-12 col-md-4">
        <div class="ds-feature">
          <!-- Tabler icon: focus -->
          <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M7 12H4"/><path d="M20 12h-3"/><path d="M12 7V4"/><path d="M12 20v-3"/></svg>
          <h3>Minimalist by design</h3>
          <p>A calm, premium interface that gets out of the way and lets the music speak.</p>
        </div>
      </div>
    </div>
  </section>

  {{ if $latest }}
  <section class="ds-featured container">
    <div class="ds-card">
      <div class="ds-card-header">
        <!-- Tabler icon: flame-like highlight (bolt) -->
        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M13 3l-4 12h6l-4 6"/></svg>
        Today’s Pick
      </div>
      <div class="ds-card-body">
        <div class="ds-featured-text">
          <h2 class="ds-featured-title"><a href="{{ $latest.RelPermalink }}">{{ $latest.Title }}</a></h2>
          {{ with $latest.Params.artists }}<p class="ds-featured-meta">{{ delimit . ", " }}</p>{{ end }}
        </div>
        {{ with $latest.Params.spotify_id }}
          <div class="spotify-embed my-3">
            <iframe 
              style="border-radius:12px" 
              src="https://open.spotify.com/embed/track/{{ . }}?utm_source=generator&theme=0" 
              width="100%" 
              height="152" 
              frameborder="0" 
              allowfullscreen 
              allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
              loading="lazy">
            </iframe>
          </div>
        {{ end }}
      </div>
      <div class="ds-card-footer">
        <a class="ds-link" href="/songs/">Browse all songs</a>
      </div>
    </div>
  </section>
  {{ end }}

  {{/* Recent Picks (last 3 songs) */}}
  {{ $recent := first 3 (sort $songs "Date" "desc") }}
  {{ if gt (len $recent) 0 }}
  <section class="ds-section" style="background: color-mix(in srgb, var(--ds-surface) 70%, var(--ds-bg) 30%);">
    <div class="ds-wrap">
      <div class="container" style="max-width: 960px;">
        <div class="d-flex align-items-center justify-content-between mb-4 mb-md-5">
          <div>
            <h2 class="ds-hero-slim" style="text-align:left; margin:0;">
              <span style="font-size: clamp(1.6rem, 3.2vw, 2.25rem); font-weight: 800; color: var(--bs-body-color);">Recent Picks</span>
            </h2>
            <p style="margin:6px 0 0; color: var(--ds-muted);">Each day brings a new perfect discovery</p>
          </div>
          <a class="btn btn-outline-dark rounded-pill ds-micro-motion" href="/songs/">
            View Archive
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ms-2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
          </a>
        </div>

        <div class="vstack gap-3 gap-md-4">
          {{ range $recent }}
          <div class="ds-card p-3 p-md-4">
            <div class="row g-3 g-md-4 align-items-center">
              <div class="col-3 col-md-2">
                <a href="{{ .RelPermalink }}" class="text-decoration-none">
                  <div class="ds-art position-relative">
                    <div class="ds-art-overlay"></div>
                    <button type="button" class="btn btn-dark btn-sm rounded-circle ds-micro-motion ds-art-play" aria-label="Open {{ .Title }}">
                      <!-- Tabler: player-play -->
                      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="7 4 19 12 7 20 7 4"></polygon></svg>
                    </button>
                  </div>
                </a>
              </div>
              <div class="col-9 col-md-6">
                <h3 class="m-0" style="font-size: 1.1rem; font-weight: 700;">
                  <a href="{{ .RelPermalink }}" class="stretched-link text-decoration-none" style="color: inherit;">{{ .Title }}</a>
                </h3>
                <div style="color: var(--ds-muted);">
                  {{ with .Params.artists }}{{ delimit . ", " }}{{ end }}
                </div>
                <div style="color: var(--ds-muted); font-size: 0.9rem;">
                  {{ with .Params.albums }}{{ index . 0 }}{{ end }}{{ with .Params.release_year }} · {{ . }}{{ end }}
                </div>
                {{ with .Params.tags }}
                <div class="mt-2" style="display:flex; flex-wrap:wrap; gap:6px;">
                  {{ range first 3 . }}
                    <a class="ds-pill" href="{{ "/tags/" | relLangURL }}{{ . | urlize }}">{{ . }}</a>
                  {{ end }}
                </div>
                {{ end }}
              </div>
              <div class="col-12 col-md-3">
                <p class="m-0" style="color: var(--ds-muted); line-height: 1.5; font-size: 0.95rem;">{{ .Summary }}</p>
              </div>
              <div class="col-12 col-md-1 text-md-end">
                <span style="font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size: 12px; color: var(--ds-muted); background: var(--ds-surface); padding: 2px 6px; border-radius: 6px; border: 1px solid var(--ds-border);">
                  {{ .Date | time.Format "Jan 2" }}
                </span>
              </div>
            </div>
          </div>
          {{ end }}
        </div>

        <div class="text-center mt-4 mt-md-5">
          <a class="btn btn-link rounded-pill ds-micro-motion" href="/songs/" style="color: var(--ds-muted); text-decoration: none;">
            Load more picks
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ms-2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
          </a>
        </div>
      </div>
    </div>
  </section>
  {{ end }}
{{ end }}

{{ define "sidebar-prefooter" }}{{ end }}
{{ define "sidebar-footer" }}{{ end }}
